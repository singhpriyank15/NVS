spark.sql("""create table all_all_r_all_bkp.ods_contacts_2ndOct22 like all_all_b_usa_crmods.ods_contacts""")
spark.sql("""insert into all_all_r_all_bkp.ods_contacts_2ndOct22 select * from all_all_b_usa_crmods.ods_contacts""")

spark.sql("""create table if not exists all_all_r_all_bkp.ods_contacts_t like all_all_b_usa_crmods.ods_contacts""")
spark.sql(""" truncate table all_all_r_all_bkp.ods_contacts_t""")


-- updating mdm_party_id 

spark.sql("insert into all_all_r_all_bkp.ods_contacts_t select distinct ods.comments,ods.org_type,ods.sonic_create_date,ods.oso_prim_org_nov,ods.tobi_validation_status,ods.contacts_identifier,ods.key_oso_mm_contact_nov,ods.oso_team_nov,ods.mm_colleague_id,ods.carcinoid_patients,ods.pnet_patients,ods.advanced_rcc_patients,ods.breast_cancer_patients,ods.brd_cert_in,ods.attestation_value_sdz,ods.medical_expert_flag,ods.lcz_attstn,ods.stt_and_fed_law_attstn,ods.compliance_attstn,ods.prod_attstn,ods.xolair_attst_prod,ods.lcz_attst_prod,ods.ims_degree,ods.ims_sfx,ods.ims_last_name,ods.ims_middle_name,ods.ims_first_name,ods.nov_spclty_code,ods.owner_dept,'44097187' mdm_party_id,ods.last_scrub_score,ods.stat_reason,ods.pdrp_opt_out_flag,ods.physician_ims_specialty_code,ods.physician_professional_type,ods.physician_crm_id,ods.physician_crm_specialty_code,ods.physician_inst_mstr_spec_code,ods.me_no,ods.email,ods.fax,ods.phone,ods.is_deleted,ods.x_thought_lead,ods.dly_scrub_date,ods.mth_scrub_date,ods.site_odw_id,ods.batch_id_insert,ods.rec_insert_by,ods.rec_modify_date,ods.rec_insert_date,ods.client,ods.call_loc_type_code,ods.src_id_2,ods.src_no_2,ods.acct_subtype,ods.title,ods.ims_loc,ods.inactive, ods.prsbr_stat,ods.scrub_stat,ods.ytd_stt_spend,ods.ytd_calls,ods.ytd_visits,ods.x_rep_key_cust_flag,ods.website,ods.vtrn_affr_hosp_flag,ods.tumor_types,ods.territories,ods.terr_vod,ods.teach_hosp,ods.tax_stat,ods.tax_id,ods.target,ods.stat_desc,ods.staff_notes,ods.spkr_rqmts,ods.speaker_flag,ods.speaker,ods.consumer_flag,ods.ter_spclty_code,ods.sec_spclty_code,ods.prim_spclty_code,ods.role_code,ods.pt_cmtt_mbr,ods.promo_spkr,ods.prof_subtype,ods.prim_nvs_contact,ods.prefd_meth_of_con,ods.prac_near_hosp,ods.prac_at_hosp,ods.prac_at_hosp_flag,ods.postn_code,ods.physician_target_flag,ods.pdrp_opt_out_end_date,ods.pdrp_opt_out_date,ods.pdrp_opt_out,ods.rems_message_status,ods.soi_lastupd_date,ods.attst_prod,ods.sphere_of_influence_usmed,ods.concerto_overall_status,ods.sec_scz_vldt_stat,ods.scz_vldt_stat,ods.prospect_date,ods.prospect_src,ods.concerto_overall_status_sdz,ods.pull_through,ods.scrub_req,ods.tsc_aml_patients,ods.tsc_sega_patients,ods.site_agmt_revw_date,ods.patnt_intr,ods.site_agmt_revw,ods.disbursed_meal_spend_sdz,ods.cushings_patients,ods.restricted_products,ods.prac_area,ods.acromegaly_patients,ods.mdm_nov_id,ods.nov_deg,ods.gilenya_attstn,ods.attestation_value,ods.pc_kam_key_account,ods.manages_patients_over_the_ao18,ods.academic_community,ods.prim_sbspcalty_nov,ods.create_date,ods.last_modified_id,ods.created_by_id,ods.certifications,ods.mm_colleague,ods.customer_segment,ods.mm_key_stakeholder,ods.mm_investigator,ods.pref_cont_mode,ods.cont_pri_acct_id,ods.cont_pager_no,ods.cont_cell_no,ods.cont_home_no,ods.sphere_of_influence,ods.category,ods.ff_department,ods.cpf_elgbl,ods.disbursed_meal_spend,ods.addr_row_id,ods.midb_pi_row_id,ods.gmm_sec_spec_code,ods.siebel_id,ods.gmm_prim_spec_code,ods.last_modified_date,ods.vendor_source_key,ods.pt_comm_mbr,ods.ok_to_samp,ods.ofc_notes,ods.third_degree,ods.sec_deg,ods.prim_deg,ods.npi_no,ods.meet_pref,ods.med_schl_attended,ods.last_call_date,ods.last_actvy,ods.kol_type,ods.kol_flag,ods.geo_lvl,ods.investigator,ods.inc_in_terr_asgnmt,ods.hcp_flag,ods.grp_spec_2,ods.grp_spec_1,ods.food_pref,ods.fellowship_location,ods.excld_from_zip_to_terr_prcsg,ods.acct_identifier,ods.high_exm_mrkt_share,ods.excld_from_terr_asgnmt_rules,ods.email_opt_out,ods.education,ods.do_not_sync_sales_data,ods.do_not_call,ods.dmr_status,ods.dept_no,ods.dec_orient_code,ods.avg_calls_per_mon,ods.attnd_flag,ods.cmpl,ods.cmpl_stt,ods.cmpl_flag,ods.cc_flag,ods.call_freq,ods.call_cls,ods.appt_required,ods.area_of_expertise,ods.birth_date,ods.formatted_nm,ods.gndr,ods.site_dba_nm,ods.job_title,ods.preferred_nm,ods.last_name,ods.mid_nm,ods.first_name,ods.salutation,ods.sfx,ods.corp_me_no,ods.prsnl_no,ods.contact_stat_ind,ods.other_relevant_info,ods.key_msl_kol_flag,ods.key_msl_contact,ods.nov_id_discrpcy_flag,ods.spend_cap,ods.spcialty_ind,ods.key_oso_mm_contact,ods.key_nasd_mmks_flag,ods.prev_meet_info,ods.residency_locn,ods.person_uid,ods.sf_recordtypeid,ods.sf_owner_id,ods.sf_is_deleted,ods.sf_id,ods.edge_id,ods.par_edge_id,ods.cam_key,ods.speaker_id,ods.sonic_id,ods.rep_nov_id,ods.nov_id,ods.src,ods.contacts_odw_id,ods.high_vol_fldx_acct,ods.segment,ods.vod_prof_type,ods.nov_id_stat,ods.prim_area_exprts_nov,ods.key_msl_contact_nov,ods.batch_id_update,ods.rec_modify_by,ods.mdm_cust_type,ods.mdm_cust_subtype,ods.country_vod__c,ods.do_not_call_vod__c,ods.language_vod__c,ods.nvs_core_account_subtype__c,ods.nvs_core_additional_details__c,ods.nvs_core_area_of_expertise__c,ods.nvs_core_assistant_email__c,ods.nvs_core_assistant_name__c,ods.nvs_core_assistant_phone__c,ods.nvs_core_channel_prefs__c,ods.nvs_core_competitor_activity__c,ods.nvs_core_council_hcp_id__c,ods.nvs_core_council_name__c,ods.nvs_core_council_region__c,ods.nvs_core_digital_id__c,ods.nvs_core_events_email__c,ods.nvs_core_holiday_end_date__c,ods.nvs_core_holiday_start_date__c,ods.nvs_core_job_title__c,ods.nvs_core_link_1__c,ods.nvs_core_link_2__c,ods.nvs_core_medical_expert_type__c,ods.nvs_core_national_id_expiration_date__c,ods.nvs_core_novartis_investigator__c,ods.nvs_core_perception_novartis__c,ods.nvs_core_practice_setting__c,ods.nvs_core_primary_area_of_expertise__c,ods.nvs_core_research_topic__c,ods.nvs_core_salesforce_id__c,ods.nvs_core_secondary_email__c,ods.nvs_core_speaker_influence_level__c,ods.nvs_core_status__c,ods.nvs_core_top_account_name__c,ods.nvs_core_vendor_id__c,ods.other_phone__c,ods.personemail,ods.primary_parent_vod__c,ods.therapeutic_area__c,ods.vl_link_vod__c,ods.kol_vod__c,ods.specialty_2_vod__c,ods.suffix,ods.hcp_phone,ods.specialty_1_vod__c,ods.nvs_core_degree__c  from all_all_b_usa_crmods.ods_contacts ods where sf_id ='00170000013iqovAAA'")

-- inactive = true

spark.sql("insert into all_all_r_all_bkp.ods_contacts_t select distinct ods.comments,ods.org_type,ods.sonic_create_date,ods.oso_prim_org_nov,ods.tobi_validation_status,ods.contacts_identifier,ods.key_oso_mm_contact_nov,ods.oso_team_nov,ods.mm_colleague_id,ods.carcinoid_patients,ods.pnet_patients,ods.advanced_rcc_patients,ods.breast_cancer_patients,ods.brd_cert_in,ods.attestation_value_sdz,ods.medical_expert_flag,ods.lcz_attstn,ods.stt_and_fed_law_attstn,ods.compliance_attstn,ods.prod_attstn,ods.xolair_attst_prod,ods.lcz_attst_prod,ods.ims_degree,ods.ims_sfx,ods.ims_last_name,ods.ims_middle_name,ods.ims_first_name,ods.nov_spclty_code,ods.owner_dept,ods.mdm_party_id,ods.last_scrub_score,ods.stat_reason,ods.pdrp_opt_out_flag,ods.physician_ims_specialty_code,ods.physician_professional_type,ods.physician_crm_id,ods.physician_crm_specialty_code,ods.physician_inst_mstr_spec_code,ods.me_no,ods.email,ods.fax,ods.phone,ods.is_deleted,ods.x_thought_lead,ods.dly_scrub_date,ods.mth_scrub_date,ods.site_odw_id,ods.batch_id_insert,ods.rec_insert_by,ods.rec_modify_date,ods.rec_insert_date,ods.client,ods.call_loc_type_code,ods.src_id_2,ods.src_no_2,ods.acct_subtype,ods.title,ods.ims_loc,'true' inactive, ods.prsbr_stat,ods.scrub_stat,ods.ytd_stt_spend,ods.ytd_calls,ods.ytd_visits,ods.x_rep_key_cust_flag,ods.website,ods.vtrn_affr_hosp_flag,ods.tumor_types,ods.territories,ods.terr_vod,ods.teach_hosp,ods.tax_stat,ods.tax_id,ods.target,ods.stat_desc,ods.staff_notes,ods.spkr_rqmts,ods.speaker_flag,ods.speaker,ods.consumer_flag,ods.ter_spclty_code,ods.sec_spclty_code,ods.prim_spclty_code,ods.role_code,ods.pt_cmtt_mbr,ods.promo_spkr,ods.prof_subtype,ods.prim_nvs_contact,ods.prefd_meth_of_con,ods.prac_near_hosp,ods.prac_at_hosp,ods.prac_at_hosp_flag,ods.postn_code,ods.physician_target_flag,ods.pdrp_opt_out_end_date,ods.pdrp_opt_out_date,ods.pdrp_opt_out,ods.rems_message_status,ods.soi_lastupd_date,ods.attst_prod,ods.sphere_of_influence_usmed,ods.concerto_overall_status,ods.sec_scz_vldt_stat,ods.scz_vldt_stat,ods.prospect_date,ods.prospect_src,ods.concerto_overall_status_sdz,ods.pull_through,ods.scrub_req,ods.tsc_aml_patients,ods.tsc_sega_patients,ods.site_agmt_revw_date,ods.patnt_intr,ods.site_agmt_revw,ods.disbursed_meal_spend_sdz,ods.cushings_patients,ods.restricted_products,ods.prac_area,ods.acromegaly_patients,ods.mdm_nov_id,ods.nov_deg,ods.gilenya_attstn,ods.attestation_value,ods.pc_kam_key_account,ods.manages_patients_over_the_ao18,ods.academic_community,ods.prim_sbspcalty_nov,ods.create_date,ods.last_modified_id,ods.created_by_id,ods.certifications,ods.mm_colleague,ods.customer_segment,ods.mm_key_stakeholder,ods.mm_investigator,ods.pref_cont_mode,ods.cont_pri_acct_id,ods.cont_pager_no,ods.cont_cell_no,ods.cont_home_no,ods.sphere_of_influence,ods.category,ods.ff_department,ods.cpf_elgbl,ods.disbursed_meal_spend,ods.addr_row_id,ods.midb_pi_row_id,ods.gmm_sec_spec_code,ods.siebel_id,ods.gmm_prim_spec_code,ods.last_modified_date,ods.vendor_source_key,ods.pt_comm_mbr,ods.ok_to_samp,ods.ofc_notes,ods.third_degree,ods.sec_deg,ods.prim_deg,ods.npi_no,ods.meet_pref,ods.med_schl_attended,ods.last_call_date,ods.last_actvy,ods.kol_type,ods.kol_flag,ods.geo_lvl,ods.investigator,ods.inc_in_terr_asgnmt,ods.hcp_flag,ods.grp_spec_2,ods.grp_spec_1,ods.food_pref,ods.fellowship_location,ods.excld_from_zip_to_terr_prcsg,ods.acct_identifier,ods.high_exm_mrkt_share,ods.excld_from_terr_asgnmt_rules,ods.email_opt_out,ods.education,ods.do_not_sync_sales_data,ods.do_not_call,ods.dmr_status,ods.dept_no,ods.dec_orient_code,ods.avg_calls_per_mon,ods.attnd_flag,ods.cmpl,ods.cmpl_stt,ods.cmpl_flag,ods.cc_flag,ods.call_freq,ods.call_cls,ods.appt_required,ods.area_of_expertise,ods.birth_date,ods.formatted_nm,ods.gndr,ods.site_dba_nm,ods.job_title,ods.preferred_nm,ods.last_name,ods.mid_nm,ods.first_name,ods.salutation,ods.sfx,ods.corp_me_no,ods.prsnl_no,ods.contact_stat_ind,ods.other_relevant_info,ods.key_msl_kol_flag,ods.key_msl_contact,ods.nov_id_discrpcy_flag,ods.spend_cap,ods.spcialty_ind,ods.key_oso_mm_contact,ods.key_nasd_mmks_flag,ods.prev_meet_info,ods.residency_locn,ods.person_uid,ods.sf_recordtypeid,ods.sf_owner_id,ods.sf_is_deleted,ods.sf_id,ods.edge_id,ods.par_edge_id,ods.cam_key,ods.speaker_id,ods.sonic_id,ods.rep_nov_id,ods.nov_id,ods.src,ods.contacts_odw_id,ods.high_vol_fldx_acct,ods.segment,ods.vod_prof_type,ods.nov_id_stat,ods.prim_area_exprts_nov,ods.key_msl_contact_nov,ods.batch_id_update,ods.rec_modify_by,ods.mdm_cust_type,ods.mdm_cust_subtype,ods.country_vod__c,ods.do_not_call_vod__c,ods.language_vod__c,ods.nvs_core_account_subtype__c,ods.nvs_core_additional_details__c,ods.nvs_core_area_of_expertise__c,ods.nvs_core_assistant_email__c,ods.nvs_core_assistant_name__c,ods.nvs_core_assistant_phone__c,ods.nvs_core_channel_prefs__c,ods.nvs_core_competitor_activity__c,ods.nvs_core_council_hcp_id__c,ods.nvs_core_council_name__c,ods.nvs_core_council_region__c,ods.nvs_core_digital_id__c,ods.nvs_core_events_email__c,ods.nvs_core_holiday_end_date__c,ods.nvs_core_holiday_start_date__c,ods.nvs_core_job_title__c,ods.nvs_core_link_1__c,ods.nvs_core_link_2__c,ods.nvs_core_medical_expert_type__c,ods.nvs_core_national_id_expiration_date__c,ods.nvs_core_novartis_investigator__c,ods.nvs_core_perception_novartis__c,ods.nvs_core_practice_setting__c,ods.nvs_core_primary_area_of_expertise__c,ods.nvs_core_research_topic__c,ods.nvs_core_salesforce_id__c,ods.nvs_core_secondary_email__c,ods.nvs_core_speaker_influence_level__c,ods.nvs_core_status__c,ods.nvs_core_top_account_name__c,ods.nvs_core_vendor_id__c,ods.other_phone__c,ods.personemail,ods.primary_parent_vod__c,ods.therapeutic_area__c,ods.vl_link_vod__c,ods.kol_vod__c,ods.specialty_2_vod__c,ods.suffix,ods.hcp_phone,ods.specialty_1_vod__c,ods.nvs_core_degree__c  from all_all_b_usa_crmods.ods_contacts ods where sf_id in ('0011O00002GIzBkQAL','0011O00002Kvi7TQAR','0011O00002PtFELQA3','0011O00002Qd54pQAB','0011O00002Qd55TQAR','0011O00002Qd56iQAB','0011O00002Qd580QAB','0011O00002Qd585QAB','0011O00002Qd625QAB','0011O00002Qd62iQAB','0011O00002Qd62YQAR','0011O00002Qd637QAB','0011O00002Qd63bQAB','0011O00002Qd6wIQAR','0011O00002Qd6wmQAB','0011O00002Qd6wNQAR','0011O00002Qd6xBQAR','0011O00002Qd6xfQAB','0011O00002Qd6ydQAB','0011O00002Qd6yJQAR','0011O00002Qd7reQAB','0011O00002Qd7roQAB','0011O00002Qd7rPQAR','0011O00002Qd7taQAB','0011O00002Qd7tBQAR','0011O00002Qd7tfQAB','0011O00002Qd7tLQAR','0011O00002Qd7tQQAR','0011O00002Qd7tuQAB','0011O00002Qd7u9QAB','0011O00002RcpdLQAR','0011O00002RcyIaQAJ','0011O00002Rg3ckQAB','0011O00002RJERuQAP','0011O00002RJET7QAP','0011O00002RJFNOQA5','0011O00002RJFNTQA5','0011O00002RJFOCQA5','0011O00002RJFQXQA5','0011O00002RJGKqQAP','0011O00002RJGM3QAP','0011O00002RJGMwQAP','0011O00002RJGMXQA5','0011O00002RJGNaQAP','0011O00002RJGNGQA5','0011O00002RJIGaQAP','0011O00002RJIGBQA5','0011O00002RJII7QAP','0011O00002RJIJeQAP','0011O00002RJIJyQAP','0011O00002RJJCuQAP','0011O00002RJJD4QAP','0011O00002RJJDiQAP','0011O00002RJJDsQAP','0011O00002RJJDTQA5','0011O00002RJJDxQAP','0011O00002RJJE7QAP','0011O00002RJJEHQA5','0011O00002RJJERQA5','0011O00002RJJFPQA5','0011O00002RJJFuQAP','0011O00002RJKBgQAP','0011O00002RJKBqQAP','0011O00002RJKBvQAP','0011O00002RJL6FQAX','0011O00002RJL6UQAX','0011O00002RLpawQAD','0011O00002RmWJzQAN','0011O00002RMXaWQAX','0011O00002RqefxQAB','0011O00002RqEmvQAF','0011O00002Rqh3RQAR','0011O00002RqhmQQAR','0011O00002RqhXaQAJ','0011O00002RqidhQAB','0011O00002RqidvQAB','0011O00002RqiGjQAJ','0011O00002RqiQYQAZ','0011O00002RqjY6QAJ','0011O00002RqKgoQAF','0011O00002RqkwmQAB','0011O00002RqlcqQAB','0011O00002RqLWaQAN','0011O00002Rqmi6QAB','0011O00002RqNgpQAF','0011O00002RqNhlQAF','0011O00002RqnMWQAZ','0011O00002RqNOhQAN','0011O00002RqnYiQAJ','0011O00002RqP1LQAV','0011O00002RqP6xQAF','0011O00002RqPKRQA3','0011O00002RqqAAQAZ','0011O00002RqqM2QAJ','0011O00002Rqr27QAB','0011O00002Rqrv1QAB','0011O00002RqsFeQAJ','0011O00002RqtKOQAZ','0011O00002RqtP5QAJ','0011O00002RqtU7QAJ','0011O00002RquRuQAJ','0011O00002RquUsQAJ','0011O00002RquuuQAB','0011O00002Rqv2cQAB','0011O00002RqV5tQAF','0011O00002RqvcWQAR','0011O00002RqvcYQAR','0011O00002RqVHjQAN','0011O00002RqvocQAB','0011O00002RqVQXQA3','0011O00002Rqw7pQAB','0011O00002RqwFgQAJ','0011O00002RqWLVQA3','0011O00002RqXLhQAN','0011O00002RqXy5QAF','0011O00002RqXy9QAF','0011O00002RqYJ3QAN','0011O00002Rr2nMQAR','0011O00002Rr2ueQAB','0011O00002Rr3XMQAZ','0011O00002Rr4VMQAZ','0011O00002Rr5R1QAJ','0011O00002Rr6hsQAB','0011O00002Rr78KQAR','0011O00002Rr7i0QAB','0011O00002Rr8cvQAB','0011O00002Rr8wbQAB','0011O00002Rr9NJQAZ','0011O00002RrA1OQAV','0011O00002RrB8gQAF','0011O00002RrCoOQAV','0011O00002RrGxlQAF','0011O00002RrJUwQAN','0011O00002RstusQAB','0011O00002RudMAQAZ','0011O00002RWy0YQAT','0011O00002RYPFpQAP','0011O00002RzcN2QAJ','0011O00002RZDFHQA5','0011O00002VO02PQAT','0011O00002VOkbnQAD','0011O00002VPEjGQAX','0013900001bOF5yAAG','0013900001d8DSEAA2','0013900001eArClAAK','0013900001htGP6AAM','0013900001mDPGzAAO','0013900001Q07I1AAJ','0013900001Q07lpAAB','00170000010RDxwAAG','00170000011z69nAAA','0011O00002QZ3C2QAL','0011O00002LoeQLQAZ','0011O00002RLclDQAT','0011O00002QZYDhQAP','0011O00002MF0XsQAL','0011O00002QZ4bRQAT','0011O00002NdgmHQAR','0011O00002RLdSTQA1','0011O00002RLcoTQAT','0011O00002ONfXBQA1','0011O00002ONHzVQAX','0011O00002RLipCQAT','0011O00002RLc18QAD','0011O00002RLfKZQA1','0011O00002ONfUgQAL','0011O00002ONfU7QAL','0011O00002ONPhKQAX','0011O00002ONXF9QAP','0011O00002RLfNtQAL','0011O00002ONWpuQAH','0011O00002RLdHsQAL','0011O00002JUOLGQA5','0011O00002MhwUwQAJ','0011O00002ON6R3QAL')")


spark.sql("insert into all_all_r_all_bkp.ods_contacts_t select ods.* from all_all_b_usa_crmods.ods_contacts ods left anti join all_all_r_all_bkp.ods_contacts_t tmp on tmp.sf_id =ods.sf_id")



spark.sql("truncate table all_all_b_usa_crmods.ods_contacts")
spark.sql("insert into all_all_b_usa_crmods.ods_contacts select * from all_all_r_all_bkp.ods_contacts_t")





